<blockquote class="note">
  <p>操作功能前請先登入</p>
</blockquote>

<blockquote>
  <p>詳細功能請參考<a href="/pfcftest/API/product">API Reference/product</a></p>
</blockquote>

<blockquote>
  <p>範例<a href="/pfcftest/%E6%95%99%E5%AD%B8/sample/%E5%95%86%E5%93%81%E5%8F%96%E5%BE%97%E7%AF%84%E4%BE%8B.ipynb">下載</a></p>
</blockquote>

<h2 id="內期商品查詢">內期商品查詢</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 內期商品取得範例
# 初始數據
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'商品代號'</span><span class="p">,</span> <span class="s">'商品名稱'</span><span class="p">,</span> <span class="s">'股票代碼'</span><span class="p">,</span> <span class="s">'類別'</span><span class="p">,</span> <span class="s">'合約基數'</span><span class="p">]</span>
<span class="n">p09s</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_p09s</span><span class="p">()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">p09s</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'商品代號'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">kind_id</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'商品名稱'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">name</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'股票代碼'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">stock_id</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'類別'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">subtype</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'合約基數'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">contract_size</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>

</code></pre></div></div>

<h2 id="內期商品期貨合約查詢">內期商品期貨合約查詢</h2>
<p>傳入類別碼請參考<a href="/pfcftest/%E8%AA%AA%E6%98%8E/%E5%85%A7%E6%9C%9F%E5%95%86%E5%93%81%E9%A1%9E%E5%88%A5">內期商品類別</a></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 內期期貨合約取得範例  
# 初始數據
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'商品代號'</span><span class="p">,</span><span class="s">'年月'</span><span class="p">,</span><span class="s">'CP'</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">,</span><span class="s">'漲停價'</span><span class="p">,</span><span class="s">'跌停價'</span><span class="p">,</span><span class="s">'參考價'</span><span class="p">]</span>
<span class="n">query_response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_p08mf</span><span class="p">(</span><span class="s">"TXF"</span><span class="p">)</span><span class="c1">#商品類別碼
</span><span class="k">if</span> <span class="n">query_response</span><span class="p">.</span><span class="n">ok</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">query_response</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>   
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'商品代號'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">prod_id</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'年月'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">month</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'CP'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">cp</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">stikeprice</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'漲停價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">maxprice</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'跌停價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">minprice</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'參考價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">premium</span> 
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> 
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">query_response</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>

</code></pre></div></div>
<h2 id="內期商品選擇權合約查詢">內期商品選擇權合約查詢</h2>
<p>傳入類別碼請參考<a href="/pfcftest/%E8%AA%AA%E6%98%8E/%E5%85%A7%E6%9C%9F%E5%95%86%E5%93%81%E9%A1%9E%E5%88%A5">內期商品類別</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 內期選擇權合約取得範例  
# 初始數據
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'商品代號'</span><span class="p">,</span><span class="s">'年月'</span><span class="p">,</span><span class="s">'CP'</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">,</span><span class="s">'漲停價'</span><span class="p">,</span><span class="s">'跌停價'</span><span class="p">,</span><span class="s">'參考價'</span><span class="p">]</span>
<span class="n">query_response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_p08m</span><span class="p">(</span><span class="s">"TXO"</span><span class="p">)</span><span class="c1">#商品類別碼
</span><span class="k">if</span> <span class="n">query_response</span><span class="p">.</span><span class="n">ok</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">query_response</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>   
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'商品代號'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">prod_id</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'年月'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">month</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'CP'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">cp</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">stikeprice</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'漲停價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">maxprice</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'跌停價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">minprice</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'參考價'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">premium</span> 
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> 
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">query_response</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>

</code></pre></div></div>
<h2 id="外期交易所查詢">外期交易所查詢</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 外期交易所取得範例
# 初始數據
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'交易所'</span><span class="p">,</span> <span class="s">'中文名稱'</span><span class="p">,</span> <span class="s">'區域'</span><span class="p">,</span> <span class="s">'幣別'</span><span class="p">]</span>
<span class="n">exchanges</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_exchanges</span><span class="p">()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">exchanges</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'交易所'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">exchange</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'中文名稱'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">name</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'區域'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">country</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'幣別'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">currency</span> 
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span> 
</code></pre></div></div>

<h2 id="外期商品查詢">外期商品查詢</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 外期商品取得範例
# 初始數據
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'交易所'</span><span class="p">,</span> <span class="s">'商品代碼'</span><span class="p">,</span> <span class="s">'類型(期貨:F 選擇權:O)'</span><span class="p">,</span><span class="s">'中文名稱'</span><span class="p">,</span><span class="s">'中文簡稱'</span><span class="p">,</span><span class="s">'區域'</span><span class="p">,</span> <span class="s">'幣別'</span><span class="p">]</span>
<span class="n">symboldatas</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">get_symboldatas</span><span class="p">()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">symboldatas</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'交易所'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">exchange</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'商品代碼'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">symbol</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'類型(期貨:F 選擇權:O)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="nb">type</span>
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'中文名稱'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">name</span> 
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'中文簡稱'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">shortname</span> 
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'區域'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">country</span> 
    <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'幣別'</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="n">currency</span> 
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>  
</code></pre></div></div>

<h2 id="外期商品合約查詢">外期商品合約查詢</h2>
<p>傳入商品代碼請參考<a href="/pfcftest/%E8%AA%AA%E6%98%8E/%E5%A4%96%E6%9C%9F%E5%95%86%E5%93%81">外期商品</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 外期商品取得範例
# 初始數據
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'交易所'</span><span class="p">,</span> <span class="s">'商品代碼'</span><span class="p">,</span> <span class="s">'類型(期貨:F 選擇權:O)'</span><span class="p">,</span><span class="s">'年月'</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">,</span><span class="s">'call put'</span><span class="p">,</span> <span class="s">'最後交易日'</span><span class="p">]</span> 
<span class="n">query_response</span> <span class="o">=</span><span class="n">api</span><span class="p">.</span><span class="n">get_symbol_contract</span><span class="p">(</span><span class="s">"CME"</span><span class="p">,</span><span class="s">"NQ"</span><span class="p">,</span><span class="s">"F"</span><span class="p">)</span><span class="c1">#交易所代碼,商品代碼,F:期貨O:選擇權
</span><span class="k">if</span> <span class="n">query_response</span><span class="p">.</span><span class="n">ok</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">query_response</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>   
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'交易所'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">exchange</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'商品代碼'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">symbol</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'類型(期貨:F 選擇權:O)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nb">type</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'年月'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">monthyear</span> 
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'履約價'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">strikeprice</span> 
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'call put'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">cp</span> 
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">'最後交易日'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">lasttradedate</span> 
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> 
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">query_response</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>
</code></pre></div></div>

