<blockquote class="note">
  <p>操作功能前請先登入</p>
</blockquote>

<blockquote>
  <p>詳細功能請參考 <a href="/pfcftest/API/faccount">API Reference/faccount</a></p>
</blockquote>

<blockquote>
  <p>範例<a href="/pfcftest/%E6%95%99%E5%AD%B8/sample/%E5%A4%96%E6%9C%9F%E5%B8%B3%E5%8B%99%E7%AF%84%E4%BE%8B.ipynb">下載</a></p>
</blockquote>

<h2 id="保證金查詢">保證金查詢</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 保證金查詢範例
</span><span class="n">actno</span> <span class="o">=</span> <span class="s">'9808401'</span><span class="c1"># 使用帳號
# 初始數據
</span><span class="n">reply_data</span> <span class="o">=</span> <span class="p">[[</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reply_data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'幣別'</span><span class="p">,</span><span class="s">'前日帳款餘額'</span><span class="p">,</span><span class="s">'手續費'</span><span class="p">,</span><span class="s">'匯率'</span><span class="p">,</span><span class="s">'期交稅'</span><span class="p">,</span><span class="s">'存提金額'</span><span class="p">,</span><span class="s">'平倉損益'</span><span class="p">,</span><span class="s">'未平倉損益'</span><span class="p">,</span><span class="s">'買方選擇權市值'</span><span class="p">,</span><span class="s">'賣方選擇權市值'</span><span class="p">,</span><span class="s">'下單預扣權利金'</span><span class="p">,</span><span class="s">'當日權利金收支'</span><span class="p">,</span><span class="s">'淨值'</span><span class="p">,</span><span class="s">'原始保證金'</span><span class="p">,</span><span class="s">'維持保證金'</span><span class="p">,</span><span class="s">'可用餘額'</span><span class="p">,</span><span class="s">'下單可用保證金'</span><span class="p">,</span><span class="s">'當日委託保證金'</span><span class="p">,</span><span class="s">'履約損益'</span><span class="p">,</span><span class="s">'變動權利金'</span><span class="p">,</span><span class="s">'洗價時間'</span><span class="p">,</span><span class="s">'追繳金額'</span><span class="p">,</span><span class="s">'昨日未平倉損益'</span><span class="p">,</span><span class="s">'今日盤中浮動損益'</span><span class="p">,</span><span class="s">'賣方垂直價差市值'</span><span class="p">,</span><span class="s">'履約價款'</span><span class="p">,</span><span class="s">'今日餘額'</span><span class="p">,</span><span class="s">'帳戶總市值'</span><span class="p">,</span><span class="s">'足額原始保證金'</span><span class="p">,</span><span class="s">'總市值風險'</span><span class="p">,</span><span class="s">'風險係數'</span><span class="p">,</span><span class="s">'維持率'</span><span class="p">,</span><span class="s">'公司別'</span><span class="p">,</span><span class="s">'帳號'</span><span class="p">,</span><span class="s">'組別'</span><span class="p">,</span><span class="s">'交易員'</span><span class="p">]</span>
<span class="c1">#查詢保證金
</span><span class="n">query_reply_response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">faccount</span><span class="p">.</span><span class="n">get_margin</span><span class="p">(</span><span class="n">actno</span><span class="p">)</span>
<span class="k">if</span> <span class="n">query_reply_response</span><span class="p">.</span><span class="n">ok</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">query_reply_response</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>   
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'幣別'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">currency</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'前日帳款餘額'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">previous_day_balance</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'手續費'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">commission</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'匯率'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">exchange_rate</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'期交稅'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">futures_tax</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'存提金額'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">deposit_withdrawal_amount</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'平倉損益'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">close_pnl</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'未平倉損益'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">unrealized_pnl</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買方選擇權市值'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">buy_option_market_value</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'賣方選擇權市值'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">sell_option_market_value</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'下單預扣權利金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">order_withholding_premium</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'當日權利金收支'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">today_premium_income_expense</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'淨值'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">net_value</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'原始保證金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">original_margin</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'維持保證金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">maintenance_margin</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'可用餘額'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">available_balance</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'下單可用保證金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">order_available_margin</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'當日委託保證金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">today_order_margin</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'履約損益'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">performance_pnl</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'變動權利金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">variable_premium</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'洗價時間'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">marking_time</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'追繳金額'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">additional_payment</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'昨日未平倉損益'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">yesterday_unrealized_pnl</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'今日盤中浮動損益'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">today_intraday_unrealized_pnl</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'賣方垂直價差市值'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">sell_vertical_spread_market_value</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'履約價款'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">strike_payment</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'今日餘額'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">today_balance</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'帳戶總市值'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">account_total_market_value</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'足額原始保證金'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">full_original_margin</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'總市值風險'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">total_market_value_risk</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'風險係數'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">risk_coefficient</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'維持率'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">maintenance_rate</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'公司別'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">company_type</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'帳號'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">account</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'組別'</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">group</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'交易員 '</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">trader</span> 
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> 
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">query_reply_response</span><span class="p">.</span><span class="n">error</span><span class="p">)</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>幣別</th>
      <th>前日帳款餘額</th>
      <th>手續費</th>
      <th>匯率</th>
      <th>期交稅</th>
      <th>存提金額</th>
      <th>平倉損益</th>
      <th>未平倉損益</th>
      <th>買方選擇權市值</th>
      <th>賣方選擇權市值</th>
      <th>下單預扣權利金</th>
      <th>當日權利金收支</th>
      <th>淨值</th>
      <th>原始保證金</th>
      <th>維持保證金</th>
      <th>可用餘額</th>
      <th>下單可用保證金</th>
      <th>當日委託保證金</th>
      <th>履約損益</th>
      <th>變動權利金</th>
      <th>洗價時間</th>
      <th>追繳金額</th>
      <th>昨日未平倉損益</th>
      <th>今日盤中浮動損益</th>
      <th>賣方垂直價差市值</th>
      <th>履約價款</th>
      <th>今日餘額</th>
      <th>帳戶總市值</th>
      <th>足額原始保證金</th>
      <th>總市值風險</th>
      <th>風險係數</th>
      <th>維持率</th>
      <th>公司別</th>
      <th>帳號</th>
      <th>組別</th>
      <th>交易員</th>
      <th>交易員</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>***</td>
      <td>52598.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20208974.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20261572.0</td>
      <td>145954289.0</td>
      <td>132328122.0</td>
      <td>-145901691.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>-125692717.0</td>
      <td>0.0</td>
      <td>20208974.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>52598.0</td>
      <td>20261572.0</td>
      <td>145954289.0</td>
      <td>13.88</td>
      <td>13.88</td>
      <td>15.31</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>GBP</td>
      <td>-15.3</td>
      <td>0.0</td>
      <td>41.24</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1287.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-1302.8</td>
      <td>2640.0</td>
      <td>2400.0</td>
      <td>-3942.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>094743</td>
      <td>-3942.8</td>
      <td>0.0</td>
      <td>-1287.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-15.3</td>
      <td>-1302.8</td>
      <td>2640.0</td>
      <td>-49.35</td>
      <td>-49.35</td>
      <td>-54.28</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>HKD</td>
      <td>12832.0</td>
      <td>0.0</td>
      <td>4.14</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-13100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-268.0</td>
      <td>192850.0</td>
      <td>154280.0</td>
      <td>-193118.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>140909</td>
      <td>-193118.0</td>
      <td>0.0</td>
      <td>-13100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12832.0</td>
      <td>-268.0</td>
      <td>192850.0</td>
      <td>-0.14</td>
      <td>-0.14</td>
      <td>-0.17</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>NTD</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>9999.99</td>
      <td>9999.99</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>USD</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>32.39</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>627188.48</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>627188.48</td>
      <td>4477699.0</td>
      <td>4062290.0</td>
      <td>-4477699.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>140909</td>
      <td>-3850510.52</td>
      <td>0.0</td>
      <td>627188.48</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>627188.48</td>
      <td>4477699.0</td>
      <td>14.01</td>
      <td>14.01</td>
      <td>15.44</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>AUD</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>21.37</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>CHF</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>36.23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>CNY</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.45</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>DEM</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.45</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>EUD</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>34.88</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>JPY</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>11</th>
      <td>RMB</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>12</th>
      <td>SGD</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>23.98</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>13</th>
      <td>THB</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.89</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
    <tr>
      <th>14</th>
      <td>ZAR</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.72</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>F008000</td>
      <td>9808401</td>
      <td></td>
      <td>NaN</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="未平倉查詢">未平倉查詢</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 未平倉查詢範例
</span><span class="n">actno</span> <span class="o">=</span> <span class="s">'9808401'</span><span class="c1"># 使用帳號
# 初始數據
</span><span class="n">reply_data</span><span class="o">=</span><span class="p">[[</span> <span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reply_data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span> <span class="s">'客戶帳號'</span><span class="p">,</span> <span class="s">'交易所'</span><span class="p">,</span> <span class="s">'買賣別1'</span><span class="p">,</span> <span class="s">'交易種類1'</span><span class="p">,</span> <span class="s">'商品代號1'</span><span class="p">,</span> <span class="s">'商品年月1'</span><span class="p">,</span> <span class="s">'履約價1'</span><span class="p">,</span> <span class="s">'買賣權1'</span><span class="p">,</span> <span class="s">'未平倉量1'</span><span class="p">,</span> <span class="s">'結算價1'</span><span class="p">,</span> <span class="s">'及時價1'</span><span class="p">,</span> <span class="s">'未平倉損益1'</span><span class="p">,</span> <span class="s">'原始保證金1'</span><span class="p">,</span> <span class="s">'維持保證金1'</span><span class="p">,</span> <span class="s">'幣別1'</span><span class="p">,</span> <span class="s">'成交價1'</span><span class="p">,</span> <span class="s">'上手代號'</span><span class="p">,</span> <span class="s">'未平倉損益-約當台幣1'</span><span class="p">,</span> <span class="s">'手續費1'</span><span class="p">,</span> <span class="s">'營業稅1'</span><span class="p">,</span> <span class="s">'淨未平倉損益1'</span><span class="p">,</span> <span class="s">'淨未平倉損益-約當台幣1'</span><span class="p">,</span> <span class="s">'簡稱'</span><span class="p">,</span> <span class="s">'後台Pricebase'</span><span class="p">,</span> <span class="s">'顯示pricebase'</span><span class="p">]</span>
<span class="c1">#查詢未平倉
</span><span class="n">query_reply_response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">faccount</span><span class="p">.</span><span class="n">get_unliquidation</span><span class="p">(</span><span class="n">actno</span><span class="p">)</span>
<span class="k">if</span> <span class="n">query_reply_response</span><span class="p">.</span><span class="n">ok</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">query_reply_response</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>   
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'客戶帳號'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">client_account</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'交易所'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">exchange</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買賣別1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">buy_sell_type_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'交易種類1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">trade_type_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'商品代號1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">product_code_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'商品年月1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">product_year_month_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'履約價1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">strike_price_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買賣權1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">buy_sell_option_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'未平倉量1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">open_interest_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'結算價1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">settlement_price_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'及時價1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">spot_price_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'未平倉損益1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">unrealized_pnl_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'原始保證金1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">initial_margin_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'維持保證金1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">maintenance_margin_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'幣別1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">currency_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'成交價1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">deal_price_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'上手代號'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">broker_code</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'未平倉損益-約當台幣1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">unrealized_pnl_ntd_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'手續費1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">commission_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'營業稅1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">business_tax_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'淨未平倉損益1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">net_open_interest_pnl_1</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'淨未平倉損益-約當台幣1'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">net_open_interest_pnl_ntd_1</span> 
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'簡稱'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">abbreviation</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'後台Pricebase'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">backend_pricebase</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'顯示pricebase'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">display_pricebase</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>  
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">query_reply_response</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> 



</code></pre></div></div>

<h2 id="即時部位查詢">即時部位查詢</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 即時部位查詢範例
</span><span class="n">actno</span> <span class="o">=</span> <span class="s">'9808401'</span><span class="c1"># 使用帳號
# 初始數據
</span><span class="n">reply_data</span><span class="o">=</span><span class="p">[[</span>  <span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">,</span><span class="s">''</span><span class="p">]]</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reply_data</span><span class="p">)</span>
<span class="n">dd</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>  <span class="s">'客戶帳號'</span><span class="p">,</span><span class="s">'交易所'</span><span class="p">,</span><span class="s">'交易種類'</span><span class="p">,</span><span class="s">'商品代號'</span><span class="p">,</span><span class="s">'商品年月'</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">,</span><span class="s">'買賣權'</span><span class="p">,</span><span class="s">'淨買'</span><span class="p">,</span><span class="s">'淨賣'</span><span class="p">,</span><span class="s">'買方留倉'</span><span class="p">,</span><span class="s">'賣方留倉'</span><span class="p">,</span><span class="s">'買方成交'</span><span class="p">,</span><span class="s">'賣方成交'</span><span class="p">,</span><span class="s">'買方委託'</span><span class="p">,</span><span class="s">'賣方委託'</span><span class="p">,</span><span class="s">'交割日期'</span><span class="p">,</span><span class="s">'幣別'</span><span class="p">,</span><span class="s">'成交均價'</span><span class="p">,</span><span class="s">'即時價'</span><span class="p">,</span><span class="s">'未平倉損益'</span><span class="p">,</span><span class="s">'平倉口數'</span><span class="p">,</span><span class="s">'平倉損益'</span><span class="p">,</span><span class="s">'簡稱'</span><span class="p">,</span><span class="s">'Pricebase'</span><span class="p">]</span>
<span class="c1">#查詢即時部位
</span><span class="n">query_reply_response</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">faccount</span><span class="p">.</span><span class="n">get_position</span><span class="p">(</span><span class="n">actno</span><span class="p">,</span> <span class="s">'NTT'</span><span class="p">)</span>
<span class="k">if</span> <span class="n">query_reply_response</span><span class="p">.</span><span class="n">ok</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">query_reply_response</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>    
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'客戶帳號'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">client_account</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'交易所'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">exchange</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'交易種類'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">trade_type</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'商品代號'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">product_code</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'商品年月'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">product_year_month</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'履約價'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">strike_price</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買賣權'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">buy_sell_option</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'淨買'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">net_buy</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'淨賣'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">net_sell</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買方留倉'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">buyer_position</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'賣方留倉'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">seller_position</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買方成交'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">buyer_transaction</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'賣方成交'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">seller_transaction</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'買方委託'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">buyer_order</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'賣方委託'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">seller_order</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'交割日期'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">delivery_date</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'幣別'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">currency</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'成交均價'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">average_deal_price</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'即時價'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">instant_price</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'未平倉損益'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">unrealized_pnl</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'平倉口數'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">close_volume</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'平倉損益'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">close_pnl</span> 
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'簡稱'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">abbreviation</span>
        <span class="n">dd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">'Pricebase'</span><span class="p">]</span><span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">price_base</span> 
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>  
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">query_reply_response</span><span class="p">.</span><span class="n">error</span><span class="p">)</span> 


</code></pre></div></div>

